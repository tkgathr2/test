## 【最優先】パーツスカウト制度（全ての開発の大原則）

**自分で作るより、世界の優れたパーツ（ライブラリ・パッケージ）を使え。自作は最終手段。**

新機能を実装する際、コードを書く前に必ず世界のメジャーサイトから既存パーツを調査し、品質の高いOSSを優先的に採用すること。世界中の開発者が作り、テストし、メンテナンスしているパーツは、自作コードより品質・信頼性・保守性が高い。

### 適用タイミング（必須）
- 新機能を追加する時（例：「Google認証つけて」「決済機能追加」「PDF生成」等）
- 新プロジェクトを作る時
- 既存機能を置き換える時
- ※既存コードのバグ修正・軽微な修正のみ適用外

### 調査フロー（コードを書く前に必ず実行）

1. **過去の採用実績を検索**（ノウハウキング君に蓄積済み）
```bash
curl -s -X POST https://knowhow.up.railway.app/api/devin/recall \
  -H 'Content-Type: application/json' \
  -d '{"project_key":"<リポジトリ名>","query":"パーツスカウト parts-scout <機能名>","top_k":5}'
```
過去に同じ機能で採用済みのパーツがあれば、調査をスキップしてそのパーツを再利用する。

2. **世界のメジャーサイトから広く調査**（最大30サイトまで参照可）

#### 参照OKなサイト（信頼性の高い有名サイトに限定）

| カテゴリ | サイト例 |
|----------|----------|
| ソースコード | GitHub, GitLab, Bitbucket |
| JSパッケージ | npm, yarn, pnpm, jsDelivr, unpkg |
| Pythonパッケージ | PyPI, conda-forge |
| 他言語パッケージ | crates.io (Rust), pkg.go.dev (Go), RubyGems, NuGet, Maven Central |
| キュレーション | Awesome Lists (awesome-xxx), OpenBase, LibHunt |
| 公式ドキュメント | React公式, Next.js公式, FastAPI公式, Django公式 等 |
| 技術コミュニティ | Stack Overflow, Dev.to, Zenn, Qiita |
| 比較サイト | Snyk Advisor, Socket.dev, Bundlephobia |

#### 参照NGなサイト
- 個人ブログ（技術コミュニティサイト以外）
- 無名・信頼性不明のサイト
- アフィリエイト目的のまとめサイト

### 採用基準（全て満たすこと）

| 基準 | 条件 |
|------|------|
| 人気度 | GitHub スター 1,000+ または 週間DL 10万+ |
| メンテナンス | 最終コミットが6ヶ月以内 |
| 型安全 | TypeScript対応（JS）/ Type Hints対応（Python） |
| テスト | テストスイートが存在する |
| ライセンス | MIT / Apache 2.0 / BSD（商用利用OK） |
| ドキュメント | README + 基本的なドキュメントが整備されている |

### 報告フォーマット（調査後、必ずユーザーに報告）

```
【パーツスカウト結果】機能名: ○○

候補1: <パッケージ名> ⭐<スター数> DL:<週間DL数>
  - URL: <GitHub URL>
  - 最終更新: <日付>
  - 推奨理由: <一言>

候補2: ...
候補3: ...

推奨: 候補<N>（理由: ...）
```

### 採用後の記録（ノウハウキング君に自動記録）

```bash
curl -s -X POST https://knowhow.up.railway.app/api/devin/memorize \
  -H 'Content-Type: application/json' \
  -d '{"project_key":"<リポジトリ名>","tool":"devin","status":"success","environment":"local","raw_log":"【パーツ採用】<パッケージ名> v<バージョン> を <機能名> に採用。選定理由: <理由>。GitHub Stars: <数>。","tags":["parts-scout","<パッケージ名>","<技術カテゴリ>"]}'
```

### 例外（自作が許可されるケース）
- 調査の結果、適切なOSSパーツが存在しない場合
- 既存パーツが全て採用基準を満たさない場合
- ユーザーが明示的に「自作して」と指示した場合
この場合も、調査結果を報告してから自作に進むこと。

---

## DEVIN運用ルール（憲法）自動読み込み
セッション開始時にDEVIN運用ルールを読み込んでください。

```bash
curl -s -X POST https://knowhow.up.railway.app/api/devin/recall \
  -H 'Content-Type: application/json' \
  -d '{"project_key":"DEVIN_CONSTITUTION","query":"DEVIN運用ルール 憲法 運用ルール","top_k":5}'
```

返された運用ルールに従ってください。これはすべてのプロジェクトに共通するルールです。

---

## ノウハウキング君 (Knowledge DB) 自動連動ルール

ノウハウキング君 は AI 外部記憶基盤です。セッション中に過去の知見を検索し、セッション終了時に学びを記録します。

### API Base URL
https://knowhow.up.railway.app

### セッション開始時（自動）
タスクに取り掛かる前に、関連する過去の知見を検索してください。

```bash
curl -s -X POST https://knowhow.up.railway.app/api/devin/recall \
  -H 'Content-Type: application/json' \
  -d '{"project_key":"<リポジトリ名>","query":"<タスクの要約>","top_k":5}'
```

結果が返ってきた場合、その知見を参考にしてタスクを進めてください。

### セッション終了時（自動）
タスク完了後、学んだことを記録してください。

```bash
curl -s -X POST https://knowhow.up.railway.app/api/devin/memorize \
  -H 'Content-Type: application/json' \
  -d '{"project_key":"<リポジトリ名>","tool":"devin","status":"success","environment":"local","raw_log":"<セッションで学んだこと・解決した問題・重要な決定事項の要約>","tags":["<関連タグ>"]}'
```

### 知見が役に立った場合
検索結果を使って問題が解決した場合、フィードバックを送信してください。

```bash
curl -s -X POST https://knowhow.up.railway.app/api/feedback \
  -H 'Content-Type: application/json' \
  -d '{"project_key":"<リポジトリ名>","session_id":<session_id>,"query":"<検索クエリ>","returned_chunk_ids":[<chunk_ids>],"selected_chunk_ids":[<使ったchunk_ids>],"resolved":true,"was_helpful":"helpful"}'
```

### 注意事項
- project_key はリポジトリ名（例: "knowhow"）を使用
- raw_log には具体的な学び・エラーとその解決法・設定値などを含める
- tags にはテクノロジー名やカテゴリを含める（例: ["railway", "deploy", "postgresql"]）
